/// Buttons base styles
@use "sass:map" as *;
@use "sass:string" as *;
@use "../variables" as *;

%button-base {
  --btn-height: var(--#{$prefix}-control-height);
  --btn-padding: #{map-get($spacers, 2)} #{map-get($spacers, 4)};
  --btn-inner-gap: 0.5rem;
  --btn-font-weight: 500;
  --btn-line-height: 1.25rem;
  --btn-border-radius: var(--#{$prefix}-border-radius);
  --btn-font-family: var(--#{$prefix}-font-family);
  --btn-font-size: var(--#{$prefix}-btn-font-size);
  --btn-background-color: var(--#{$prefix}-surface-container);
  --btn-border-color: var(--#{$prefix}-surface-container);
  --btn-color: var(--#{$prefix}-on-surface-container);
  --btn-opacity: 1;
  --btn-elevation: none;

  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: var(--btn-inner-gap);
  height: var(--btn-height);
  padding: var(--btn-padding);
  border: 1px solid var(--btn-border-color);
  border-radius: var(--btn-border-radius);
  font-family: var(--btn-font-family);
  font-size: var(--btn-font-size);
  font-weight: var(--btn-font-weight);
  line-height: var(--btn-line-height);
  white-space: nowrap;
  text-decoration: none;
  background-color: var(--btn-background-color);
  color: var(--btn-color);
  opacity: var(--btn-opacity);
  box-shadow: var(--btn-elevation);
}

%button-inner-icon {
  :is(i, img, svg) {
    display: inline-flex;
    width: var(--#{$prefix}-btn-inner-icon-size);
    height: var(--#{$prefix}-btn-inner-icon-size);
    line-height: inherit;
  }

  svg {
    path:not([stroke]) {
      stroke: var(--btn-color);
    }
  }
}

// region button-filled

%button-filled {
  --btn-background-color: var(--#{$prefix}-primary);
  --btn-border-color: var(--#{$prefix}-primary);
  --btn-color: var(--#{$prefix}-on-primary);

  @extend %button-filled-disabled;
  @extend %button-filled-hovered;
  @extend %button-filled-focused;
  @extend %button-filled-pressed;
}

%button-filled-disabled {
  &:is(:disabled, [disabled="true"], [aria-disabled="true"]) {
    --btn-background-color: color-mix(in srgb, var(--#{$prefix}-on-surface) 12%, transparent) !important;
    --btn-color: color-mix(in srgb, var(--#{$prefix}-on-surface) 38%, transparent) !important;
    --btn-border-color: var(--btn-background-color) !important;

    cursor: default;
  }
}

%button-filled-hovered {
  &:is(:hover, [data-hovered]) {
    --btn-background-color: color-mix(in lab, var(--#{$prefix}-primary) 100%, var(--#{$prefix}-on-primary) 20%);
  }
}

%button-filled-focused {
  &:is(:focus, [data-focused]) {
    --btn-background-color: color-mix(in lab, var(--#{$prefix}-primary) 100%, var(--#{$prefix}-on-primary) 50%);
  }
}

%button-filled-pressed {
  &:is(:active, &[data-pressed]) {
    --btn-background-color: color-mix(in lab, var(--#{$prefix}-primary) 100%, var(--#{$prefix}-on-primary) 50%);
  }
}

// endregion button-filled

// region button-elevated

%button-elevated {
  --btn-color: var(--#{$prefix}-primary);
  --btn-background-color: var(--#{$prefix}-surface-container-low);
  --btn-elevation: var(--#{$prefix}-elevation-1);
}

%button-elevated-disabled {
  &:is(:disabled, [disabled="true"], [aria-disabled="true"]) {
    --btn-background-color: color-mix(in srgb, var(--#{$prefix}-on-surface) 12%, transparent) !important;
    --btn-color: color-mix(in srgb, var(--#{$prefix}-on-surface) 38%, transparent) !important;
    --btn-border-color: var(--btn-background-color);
    --btn-elevation: none !important;
  }
}

%button-elevated-hovered {
  &:is(:hover, [data-hovered]) {
    --btn-elevation: var(--#{$prefix}-elevation-2);
  }
}

%button-elevated-focused {
  &:is(:focus, [data-focused]) {
    --btn-background-color: color-mix(in srgb, var(--#{$prefix}-surface-container-low) 88%, var(--#{$prefix}-base));
    --btn-elevation: var(--#{$prefix}-elevation-1);
  }
}

%button-elevated-pressed {
  &:is(:active, &[data-pressed]) {
    --btn-background-color: color-mix(in srgb, var(--#{$prefix}-surface-container-low) 88%, var(--#{$prefix}-base));
    --btn-elevation: var(--#{$prefix}-elevation-1);
  }
}

// endregion button-elevated

// region icon button

%button-icon {
  --btn-icon-size: calc(var(--#{$prefix}-control-height) * 1.2);

  height: var(--btn-icon-size);
  width: var(--btn-icon-size);
  padding: 0;
  color: var(--#{$prefix}-on-surface-variant);
  background-color: transparent;
  border-radius: var(--#{$prefix}-control-height);
  background-position: center;
  background-size: var(--#{$prefix}-btn-icon-size);

  &:hover {
    background-color: rgb(from var(--#{$prefix}-on-surface-variant) r g b / 10%);
  }

  &:active {
    background-color: rgb(from var(--#{$prefix}-on-surface-variant) r g b / 20%);
  }
}

// endregion icon button

// region text button

%button-text {
  padding: var(--btn-padding);
  color: var(--#{$prefix}-primary);
  background-color: transparent;
  cursor: pointer;
}

// endregion text button

/////////////////////////////////////////////////
// Apply buttons styles
/////////////////////////////////////////////////

// Correct the inability to style buttons in iOS and Safari
:where(button, [type="submit"], [type="reset"], [type="button"], [role="button"]) {
  -webkit-appearance: button;
}

// Set base styles
:where(button, [type="submit"], [type="reset"], [type="button"], [role="button"]) {
  @extend %button-base;
  @extend %button-filled;
  @extend %button-inner-icon;
}

[type="file"]::file-selector-button {
  @extend %button-base;
  @extend %button-filled;
}

// Set elevated button styles
.btn-elevated {
  @extend %button-base;
  @extend %button-elevated;
  @extend %button-elevated-disabled;
  @extend %button-elevated-hovered;
  @extend %button-elevated-focused;
  @extend %button-elevated-pressed;
}

// Set button-icon styles
.btn-icon {
  @extend %button-base;
  @extend %button-icon;
}

// Set button-text styles
.btn-text {
  @extend %button-base;
  @extend %button-text;
  @extend %button-inner-icon;
}
